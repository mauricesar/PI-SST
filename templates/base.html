<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ title or "GuiaTEC" }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
  </head>
  <body>
    <header class="page-header">
      <div class="brand">
        <img src="{{ url_for('static', filename='guidetec-logo.jpeg') }}" alt="Logo GuiaTEC" />
        <div class="brand-text">
          <span class="brand-name">GuiaTEC</span>
          <span class="brand-sub">Guia de SST & Clima</span>
        </div>
      </div>
      <nav>
        <a href="{{ url_for('index') }}">Início</a>
        {% if g.user %}
          <a href="{{ url_for('survey') }}">Questionário</a>
          <a href="{{ url_for('ouvidoria') }}">Ouvidoria</a>
          {% if g.user.role == 'admin' %}
            <a href="{{ url_for('dashboard') }}">Dashboard</a>
            <a href="{{ url_for('guide') }}">Guia</a>
            <a href="{{ url_for('ouvidoria_respostas') }}">Responder Ouvidoria</a>
            <a href="{{ url_for('register') }}">Cadastrar usuários</a>
          {% endif %}
          <span class="nav-user">
            Olá, {{ g.user.preferred_name or g.user.name }} ({{ 'ADM' if g.user.role == 'admin' else 'Colaborador' }})
          </span>
          <a href="{{ url_for('logout') }}" class="pill">Sair</a>
        {% else %}
          <a href="{{ url_for('login') }}">Entrar</a>
          <a href="{{ url_for('register') }}" class="pill">Cadastro</a>
        {% endif %}
      </nav>
    </header>

    <main class="content">
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <ul class="flash-messages">
            {% for category, message in messages %}
              <li class="{{ category }}">{{ message }}</li>
            {% endfor %}
          </ul>
        {% endif %}
      {% endwith %}

      {% block content %}{% endblock %}
    </main>

    <footer class="page-footer">
      <div class="brand">
        <img src="{{ url_for('static', filename='guidetec-logo.jpeg') }}" alt="Logo GuiaTEC" />
        <div class="brand-text">
          <span class="brand-name">GuiaTEC</span>
          <span class="brand-sub">Cuidado, inovação e diálogo seguro</span>
        </div>
      </div>
      <p>Projeto Integrador - SST | Demonstração Flask + SQLite</p>
    </footer>
  </body>
</html>